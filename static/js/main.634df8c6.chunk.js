(window["webpackJsonproute-editor"]=window["webpackJsonproute-editor"]||[]).push([[0],{124:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(29),i=n.n(o),c=n(3),u=n(4),s=n(39),d=n(15),l=n(11),p=n(13),b=n(60),f=n.n(b),m=function(e,t,n){var r=f()();return{type:v.ADD_COORD,payload:{id:r,name:e,lat:t,lng:n}}},O=n(61),g=function(){return function(e){return O.a.load("https://api-maps.yandex.ru/2.1/?apikey=ec0ad35b-0d65-48bb-aff9-8343ba56b035&lang=en_US").then(function(t){return e((n=t,{type:v.INIT_YMAPS_API,payload:{yMapsApi:n}}));var n}).catch(function(e){return console.log("Failed to load Yandex Maps",e)})}},v={ADD_COORD:"ADD_COORD",DELETE_COORD:"DELETE_COORD",DND_COORD:"DND_COORD",INIT_YMAPS_API:"INIT_YMAPS_API",EDIT_COORD:"EDIT_COORD"},h=n(23);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(n,!0).forEach(function(t){Object(d.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var E={present:[],lastAction:void 0},D=n.n(h)()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0,n=e.present;switch(t.type){case v.ADD_COORD:var r=t.payload,a=r.id,o=r.name,i=r.lat,c=r.lng,u={name:o,lat:i,lng:c,id:a},s=[].concat(Object(p.a)(n),[u]),d=v.ADD_COORD;return{present:s,lastAction:d};case v.DELETE_COORD:var b=t.payload.id,f=Object(p.a)(n),m=f.splice(f.findIndex(function(e){return e.id===b}),1);f=[].concat(Object(p.a)(f.slice(0,m)),Object(p.a)(f.slice(m+1)));var O=v.DELETE_COORD;return{present:f,lastAction:O};case v.DND_COORD:var g=t.payload,h=g.startIndex,j=g.endIndex;if(h!==j){var D=Object(p.a)(n),x=D.splice(h,1),w=Object(l.a)(x,1),C=w[0];D.splice(j,0,C);var k=v.DND_COORD;return{present:D,lastAction:k}}return e;case v.EDIT_COORD:var _=t.payload,A=_.id,I=_.name,M=_.lat,R=_.lng,P=Object(p.a)(n),L=v.EDIT_COORD;return{present:P.map(function(e){return e.id===A?y({},e,{name:I,lat:M,lng:R}):e}),lastAction:L};default:return e}},{filter:Object(h.distinctState)()}),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v.INIT_YMAPS_API:var n=t.payload.yMapsApi;return n;default:return e}},w=Object(u.c)({coords:D,yMaps:x}),C=Object(u.e)(w,Object(u.a)(s.a)),k=(n(86),n(5)),_=n(6),A=n(134),I=n(135);function M(){var e=Object(k.a)(["\n    z-index: 2000;\n    position: absolute;\n    right: 0px;\n    margin-top: 10px;\n    margin-right: 5%;\n"]);return M=function(){return e},e}function R(){var e=Object(k.a)(["\n    z-index: 2000;\n    position: absolute;\n    right: 0px;\n    margin-top: 10px;\n    margin-right: 5%;\n"]);return R=function(){return e},e}function P(){var e=Object(k.a)(["\n    transition: 1s;\n    margin-left: 2px;\n    ","\n    position: absolute;\n"]);return P=function(){return e},e}var L=_.a.div(P(),function(e){return e.mobile?"width: 99%;":"width: 30%;"}),N=Object(_.a)(A.a)(R()),T=Object(_.a)(I.a)(M()),S=n(24),W=n.n(S),z=n(41);function Y(){var e=Object(k.a)(["\n    box-sizing: border-box;\n    background-color: #e9ecf1;\n    margin-top: 5px;\n    padding-left: 10px;\n    margin-bottom: 5px;\n    border-radius: 20px;\n    padding-top: 10px;\n    padding-bottom: 10px;\n    box-shadow: 5px 5px 5px #888888;\n    border: none;\n    width: 99%;\n    outline: none;\n    &::placeholder {\n        color: darkslategray;\n    }\n"]);return Y=function(){return e},e}function B(){var e=Object(k.a)(["\n    transition: 1s;\n    z-index:2000;\n    position: relative;\n"]);return B=function(){return e},e}var J=_.a.div(B()),F=_.a.input(Y()),H=Object(r.memo)(function(e){var t=e.dispatch,n=e.yMaps,o=e.mobile,i=Object(r.useState)(""),c=Object(l.a)(i,2),u=c[0],s=c[1],d=function(){var e=Object(z.a)(W.a.mark(function e(n){var r,a,o,i;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.key){e.next=10;break}return s(""),e.next=4,p(u);case 4:r=e.sent,a=r.gcoordName,o=r.glat,i=r.glng,r.decodeError||t(m(a,o,i));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(z.a)(W.a.mark(function e(t){var r,a;return W.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={gcoordName:t},a=function(e){var t=e.geoObjects.get(0);if(t){var n=t.getAddressLine(),a=t.geometry.getCoordinates();r.gcoordName=n,r.glat=a[1],r.glng=a[0]}else r.decodeError=!0},e.next=4,n.geocode(t).then(a);case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return a.a.createElement(J,{mobile:o},a.a.createElement(F,{"test-data":"newNodeInput",onKeyDown:d,onChange:function(e){s(e.target.value)},value:u,placeholder:"New node"}))}),K=Object(c.b)(function(e){return{yMaps:e.yMaps}})(H),U=n(64),V=n.n(U);function $(){var e=Object(k.a)(["\n    position: absolute;\n    cursor: pointer;\n    color: red;\n    ","    \n    left: 0px;\n    &:hover{\n        opacity: 1;\n    }\n"]);return $=function(){return e},e}function q(){var e=Object(k.a)(["\n    white-space: nowrap;\n    border-radius: 10px;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    ","\n    height: 100px;\n    background-color:  rgba(128, 128, 128, 0.7);\n    text-align: center;\n    line-height: 100px;\n"]);return q=function(){return e},e}var G=_.a.div(q(),function(e){if(!e.mobile)return"position: relative;"}),Q=Object(_.a)(V.a)($(),function(e){if(!e.mobile)return"opacity: 0.3;"}),X=Object(r.memo)(function(e){var t=e.dispatch,n=e.name,r=e.id,o=e.mobile;return a.a.createElement(G,{mobile:o},a.a.createElement("label",{"test-data":"itemName"},n),a.a.createElement(Q,{"test-data":"deleteItemBtn",mobile:o?1:0,onClick:function(){t(function(e){return{type:v.DELETE_COORD,payload:{id:e}}}(r))}}))}),Z=Object(c.b)()(X),ee=n(34);function te(){var e=Object(k.a)(["\n    ","\n    box-sizing : border-box;\n    z-index: 2000;\n    overflow-y: scroll;\n    max-height: 90vh;\n    overflow-x: hidden;\n    &::-webkit-scrollbar {\n        position: absolute;\n        width: 5px;\n    }\n    &::-webkit-scrollbar-track {\n        border-radius: 10px;\n    }\n    &::-webkit-scrollbar-thumb {\n        background: gray; \n        border-radius: 10px;\n    }\n    &::-webkit-scrollbar-thumb:hover {\n        background: #b30000; \n    }\n"]);return te=function(){return e},e}var ne=_.a.div(te(),function(e){return e.mobile?"\n                position: absolute;\n                top: 50px;\n                width: 99%;\n                margin-left: 5px;\n            ":"position: relative;"}),re=Object(r.memo)(function(e){var t=e.coords,n=e.dispatch,r=e.mobile;return a.a.createElement(ne,{mobile:r},a.a.createElement(ee.a,{onDragEnd:function(e){var t,r;e.destination&&n((t=e.source.index,r=e.destination.index,{type:v.DND_COORD,payload:{startIndex:t,endIndex:r}}))}},a.a.createElement(ee.c,{droppableId:"droppable"},function(e){return a.a.createElement("div",Object.assign({"test-data":"listOfPlaces"},e.droppableProps,{ref:e.innerRef}),t.present.present.map(function(e,t){return a.a.createElement(ee.b,{key:e.id,draggableId:e.id,index:t},function(t){return a.a.createElement("div",Object.assign({"test-data":"place","test-data-coord-id":e.id,ref:t.innerRef},t.draggableProps,t.dragHandleProps),a.a.createElement(Z,{mobile:r,key:e.id,name:e.name,id:e.id}))})}),e.placeholder)})))}),ae=Object(c.b)(function(e){return{coords:e.coords}})(re),oe=n(19),ie=n(43),ce=n.n(ie),ue=function(e){return a.a.createElement(ce.a,Object.assign({},e,{maxWidth:oe.mobileMaxWidth}))},se=function(e){return a.a.createElement(ce.a,Object.assign({},e,{minWidth:oe.desktopMinWidth}))},de=Object(r.memo)(function(e){var t=e.yMaps,n=e.coords,o=Object(r.useState)(void 0),i=Object(l.a)(o,2),c=i[0],u=i[1],s=Object(r.useState)(!1),d=Object(l.a)(s,2),p=d[0],b=d[1];Object(r.useEffect)(function(){f(),window.addEventListener("resize",f)},[]),Object(r.useEffect)(function(){return function(){window.removeEventListener("resize",f)}},[]);var f=function(){window.innerWidth<=oe.mobileMaxWidth&&u(!0),window.innerWidth>=oe.desktopMinWidth&&(b(!1),u(!1))};return a.a.createElement("div",{"test-data":"routeEditor"},t?[a.a.createElement(L,{"test-data":"desktopItemsHolder",key:"desktop",mobile:c},a.a.createElement(K,null),a.a.createElement(se,null,a.a.createElement(ae,null))),a.a.createElement(ue,{key:"mobile"},p?a.a.createElement(ae,{"test-data":"mobileListOfCoords",mobile:c}):a.a.createElement("div",null),a.a.createElement("div",{"test-data":"openListOfCoordsBtn",onClick:function(){b(!p)}},n.present.present.length>=1?p?a.a.createElement(T,null):a.a.createElement(N,null):void 0))]:void 0)}),le=Object(c.b)(function(e){return{yMaps:e.yMaps,coords:e.coords}})(de);function pe(){var e=Object(k.a)(["\n    position: relative;\n    width: 100%;\n    height: 100vh;\n"]);return pe=function(){return e},e}var be=_.a.div(pe()),fe=Object(r.memo)(function(e){var t=e.coords,n=e.yMaps,o=e.dispatch,i=Object(r.useState)(null),c=Object(l.a)(i,2),u=c[0],s=c[1];Object(r.useEffect)(function(){u||s(n?new n.Map("map",{center:[55.76,37.64],zoom:7,controls:[]}):null)},[n,u]),Object(r.useEffect)(function(){u&&d(t.present.present)});var d=function(e){e.length>1?n.route(m(e)).then(function(t){for(var n=b(t.getWayPoints()),r=function(t){n.get(t).events.add("dragend",function(n){return f(e[t].id,n)})},a=0;a<n.getLength();a++)r(a);t.editor.start({addViaPoints:!1}),u.geoObjects.removeAll(),u.geoObjects.add(t),p(e)},function(e){alert("error: "+e.message),o(h.ActionCreators.undo())}):u.geoObjects.removeAll()},p=function(e){switch(!0){case t.present.lastAction===v.ADD_COORD:n.geocode(m(e)[e.length-1]).then(function(e){u.setCenter(e.geoObjects.get(0).geometry.getCoordinates(),7)})}},b=function(e){for(var t=e,r=function(e){n.geocode(t.get(e).geometry.getCoordinates()).then(function(r){t.get(e).options.set({balloonContentLayout:n.templateLayoutFactory.createClass("<span>".concat(r.geoObjects.get(0).getAddressLine(),"</span>"))})})},a=0;a<t.getLength();a++)r(a);return t},f=function(e,t){var r=t.originalEvent.target.geometry.getCoordinates();n.geocode(r).then(function(t){var n=t.geoObjects.get(0),r=n.getAddressLine(),a=n.geometry.getCoordinates();o(function(e,t,n,r){return{type:v.EDIT_COORD,payload:{id:e,name:t,lat:n,lng:r}}}(e,r,a[1],a[0]))})},m=function(e){return e.map(function(e){return[+e.lng,+e.lat]})};return a.a.createElement("div",null,a.a.createElement(be,{"test-data":"yMaps",id:"map",key:"map"}))}),me=Object(c.b)(function(e){return{coords:e.coords,yMaps:e.yMaps}})(fe),Oe=Object(r.memo)(function(e){var t=e.dispatch;return Object(r.useEffect)(function(){t(g())},[t]),a.a.createElement("div",null,a.a.createElement(le,null),a.a.createElement(me,null))}),ge=Object(c.b)()(Oe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(c.a,{store:C},a.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},19:function(e){e.exports=JSON.parse('{"mobileMaxWidth":1024,"desktopMinWidth":1025}')},71:function(e,t,n){e.exports=n(124)},86:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.634df8c6.chunk.js.map