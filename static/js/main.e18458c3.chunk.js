(window["webpackJsonproute-editor"]=window["webpackJsonproute-editor"]||[]).push([[0],{125:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(30),i=t.n(o),c=t(3),u=t(7),l=t(15),s=t(11),d=t(13),p=t(60),b=t.n(p),f=function(e,n,t){var r=b()();return{type:m.ADD_COORD,payload:{id:r,name:e,lat:n,lng:t}}},m={ADD_COORD:"ADD_COORD",DELETE_COORD:"DELETE_COORD",DND_COORD:"DND_COORD",INIT_YMAPS_API:"INIT_YMAPS_API",EDIT_COORD:"EDIT_COORD"},O=t(24);function g(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function v(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?g(t,!0).forEach(function(n){Object(l.a)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var h={present:[],lastAction:void 0},j=t.n(O)()(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,n=arguments.length>1?arguments[1]:void 0,t=e.present;switch(n.type){case m.ADD_COORD:var r=n.payload,a=r.id,o=r.name,i=r.lat,c=r.lng,u={name:o,lat:i,lng:c,id:a},l=[].concat(Object(d.a)(t),[u]),p=m.ADD_COORD;return{present:l,lastAction:p};case m.DELETE_COORD:var b=n.payload.id,f=Object(d.a)(t),O=f.splice(f.findIndex(function(e){return e.id===b}),1);f=[].concat(Object(d.a)(f.slice(0,O)),Object(d.a)(f.slice(O+1)));var g=m.DELETE_COORD;return{present:f,lastAction:g};case m.DND_COORD:var j=n.payload,y=j.startIndex,E=j.endIndex;if(y!==E){var D=Object(d.a)(t),x=D.splice(y,1),w=Object(s.a)(x,1),C=w[0];D.splice(E,0,C);var k=m.DND_COORD;return{present:D,lastAction:k}}return e;case m.EDIT_COORD:var _=n.payload,A=_.id,M=_.name,I=_.lat,R=_.lng,P=Object(d.a)(t),L=m.EDIT_COORD;return{present:P.map(function(e){return e.id===A?v({},e,{name:M,lat:I,lng:R}):e}),lastAction:L};default:return e}},{filter:Object(O.distinctState)()}),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case m.INIT_YMAPS_API:var t=n.payload.yMapsApi;return t;default:return e}},E=Object(u.c)({coords:j,yMaps:y}),D=Object(u.e)(E),x=(t(87),t(4)),w=t(5),C=t(135),k=t(136);function _(){var e=Object(x.a)(["\n    z-index: 2000;\n    position: absolute;\n    right: 0px;\n    margin-top: 10px;\n    margin-right: 5%;\n"]);return _=function(){return e},e}function A(){var e=Object(x.a)(["\n    z-index: 2000;\n    position: absolute;\n    right: 0px;\n    margin-top: 10px;\n    margin-right: 5%;\n"]);return A=function(){return e},e}function M(){var e=Object(x.a)(["\n    transition: 1s;\n    margin-left: 2px;\n    ","\n    position: absolute;\n"]);return M=function(){return e},e}var I=w.a.div(M(),function(e){return e.mobile?"width: 99%;":"width: 30%;"}),R=Object(w.a)(C.a)(A()),P=Object(w.a)(k.a)(_()),L=t(25),N=t.n(L),S=t(41);function T(){var e=Object(x.a)(["\n    box-sizing: border-box;\n    background-color: #e9ecf1;\n    margin-top: 5px;\n    padding-left: 10px;\n    margin-bottom: 5px;\n    border-radius: 20px;\n    padding-top: 10px;\n    padding-bottom: 10px;\n    box-shadow: 5px 5px 5px #888888;\n    border: none;\n    width: 99%;\n    outline: none;\n    &::placeholder {\n        color: darkslategray;\n    }\n"]);return T=function(){return e},e}function W(){var e=Object(x.a)(["\n    transition: 1s;\n    z-index:2000;\n    position: relative;\n"]);return W=function(){return e},e}var z=w.a.form(W()),Y=w.a.input(T()),J=Object(r.memo)(function(e){var n=e.dispatch,t=e.yMaps,o=e.mobile,i=Object(r.useState)(""),c=Object(s.a)(i,2),u=c[0],l=c[1],d=function(){var e=Object(S.a)(N.a.mark(function e(t){var r,a,o,i;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.key){e.next=11;break}return t.preventDefault(),l(""),e.next=5,p(u);case 5:r=e.sent,a=r.gcoordName,o=r.glat,i=r.glng,r.decodeError||n(f(a,o,i));case 11:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}(),p=function(){var e=Object(S.a)(N.a.mark(function e(n){var r,a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={gcoordName:n},a=function(e){var n=e.geoObjects.get(0);if(n){var t=n.getAddressLine(),a=n.geometry.getCoordinates();r.gcoordName=t,r.glat=a[1],r.glng=a[0]}else r.decodeError=!0},e.next=4,t.geocode(n).then(a);case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}();return a.a.createElement(z,{mobile:o},a.a.createElement(Y,{onKeyDown:d,onChange:function(e){l(e.target.value)},value:u,placeholder:"New node"}))}),B=Object(c.b)(function(e){return{yMaps:e.yMaps}})(J),F=t(63),H=t.n(F);function K(){var e=Object(x.a)(["\n    position: absolute;\n    cursor: pointer;\n    color: red;\n    ","    \n    left: 0px;\n    &:hover{\n        opacity: 1;\n    }\n"]);return K=function(){return e},e}function U(){var e=Object(x.a)(["\n    border-radius: 10px;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    ","\n    height: 100px;\n    background-color:  rgba(128, 128, 128, 0.7);\n    text-align: center;\n    line-height: 100px;\n"]);return U=function(){return e},e}var V=w.a.div(U(),function(e){if(!e.mobile)return"position: relative;"}),$=Object(w.a)(H.a)(K(),function(e){if(!e.mobile)return"opacity: 0.3;"}),q=Object(r.memo)(function(e){var n=e.dispatch,t=e.name,r=e.id,o=e.mobile;return a.a.createElement(V,{mobile:o},a.a.createElement("label",null,t),a.a.createElement($,{mobile:o?1:0,onClick:function(){n(function(e){return{type:m.DELETE_COORD,payload:{id:e}}}(r))}}))}),G=Object(c.b)()(q),Q=t(35);function X(){var e=Object(x.a)(["\n    ","\n    box-sizing : border-box;\n    z-index: 2000;\n    overflow-y: scroll;\n    max-height: 90vh;\n    overflow-x: hidden;\n    &::-webkit-scrollbar {\n        position: absolute;\n        width: 5px;\n    }\n    &::-webkit-scrollbar-track {\n        border-radius: 10px;\n    }\n    &::-webkit-scrollbar-thumb {\n        background: gray; \n        border-radius: 10px;\n    }\n    &::-webkit-scrollbar-thumb:hover {\n        background: #b30000; \n    }\n"]);return X=function(){return e},e}var Z=w.a.div(X(),function(e){return e.mobile?"\n                position: absolute;\n                top: 50px;\n                width: 99%;\n                margin-left: 5px;\n            ":"position: relative;"}),ee=Object(r.memo)(function(e){var n=e.coords,t=e.dispatch,r=e.mobile;return a.a.createElement(Z,{mobile:r},a.a.createElement(Q.a,{onDragEnd:function(e){var n,r;e.destination&&t((n=e.source.index,r=e.destination.index,{type:m.DND_COORD,payload:{startIndex:n,endIndex:r}}))}},a.a.createElement(Q.c,{droppableId:"droppable"},function(e){return a.a.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef}),n.present.present.map(function(e,n){return a.a.createElement(Q.b,{key:e.id,draggableId:e.id,index:n},function(n){return a.a.createElement("div",Object.assign({ref:n.innerRef},n.draggableProps,n.dragHandleProps),a.a.createElement(G,{mobile:r,key:e.id,name:e.name,id:e.id}))})}),e.placeholder)})))}),ne=Object(c.b)(function(e){return{coords:e.coords}})(ee),te=t(20),re=t(43),ae=t.n(re),oe=function(e){return a.a.createElement(ae.a,Object.assign({},e,{maxWidth:te.mobileMaxWidth}))},ie=function(e){return a.a.createElement(ae.a,Object.assign({},e,{minWidth:te.desktopMinWidth}))},ce=Object(r.memo)(function(e){var n=e.yMaps,t=e.coords,o=Object(r.useState)(void 0),i=Object(s.a)(o,2),c=i[0],u=i[1],l=Object(r.useState)(!1),d=Object(s.a)(l,2),p=d[0],b=d[1];Object(r.useEffect)(function(){f(),window.addEventListener("resize",f)},[]),Object(r.useEffect)(function(){return function(){window.removeEventListener("resize",f)}},[]);var f=function(){window.innerWidth<=te.mobileMaxWidth&&u(!0),window.innerWidth>=te.desktopMinWidth&&(b(!1),u(!1))};return a.a.createElement("div",null,a.a.createElement(I,{mobile:c},n?[a.a.createElement("div",{key:"coordsSetter"},a.a.createElement(B,null)),a.a.createElement("div",{key:"listOfCoords"},a.a.createElement(ie,null,a.a.createElement(ne,null)))]:void 0),a.a.createElement(oe,null,p?a.a.createElement(ne,{mobile:c}):a.a.createElement("div",null),a.a.createElement("div",{onClick:function(){b(!p)}},t.present.present.length>=1?p?a.a.createElement(P,null):a.a.createElement(R,null):void 0)))}),ue=Object(c.b)(function(e){return{yMaps:e.yMaps,coords:e.coords}})(ce);function le(){var e=Object(x.a)(["\n    position: relative;\n    width: 100%;\n    height: 100vh;\n"]);return le=function(){return e},e}var se=w.a.div(le()),de=Object(r.memo)(function(e){var n=e.coords,t=e.yMaps,o=e.dispatch,i=Object(r.useState)(null),c=Object(s.a)(i,2),u=c[0],l=c[1];Object(r.useEffect)(function(){u||l(t?new t.Map("map",{center:[55.76,37.64],zoom:7,controls:[]}):null)},[t,u]);var d,p=function(e){switch(!0){case n.present.lastAction===m.ADD_COORD:t.geocode(g(e)[e.length-1]).then(function(e){u.setCenter(e.geoObjects.get(0).geometry.getCoordinates(),7)})}},b=function(e){for(var n=e,r=function(e){t.geocode(n.get(e).geometry.getCoordinates()).then(function(r){n.get(e).options.set({balloonContentLayout:t.templateLayoutFactory.createClass("<span>".concat(r.geoObjects.get(0).getAddressLine(),"</span>"))})})},a=0;a<n.getLength();a++)r(a);return n},f=function(e,n){var r=n.originalEvent.target.geometry.getCoordinates();t.geocode(r).then(function(n){var t=n.geoObjects.get(0),r=t.getAddressLine(),a=t.geometry.getCoordinates();o(function(e,n,t,r){return{type:m.EDIT_COORD,payload:{id:e,name:n,lat:t,lng:r}}}(e,r,a[1],a[0]))})},g=function(e){return e.map(function(e){return[+e.lng,+e.lat]})};return a.a.createElement("div",null,a.a.createElement(se,{id:"map",key:"map"}),u?void((d=n.present.present).length>1?t.route(g(d)).then(function(e){for(var n=b(e.getWayPoints()),t=function(e){n.get(e).events.add("dragend",function(n){return f(d[e].id,n)})},r=0;r<n.getLength();r++)t(r);e.editor.start({addViaPoints:!1}),u.geoObjects.removeAll(),u.geoObjects.add(e),p(d)},function(e){alert("error: "+e.message),o(O.ActionCreators.undo())}):u.geoObjects.removeAll()):void 0)}),pe=Object(c.b)(function(e){return{coords:e.coords,yMaps:e.yMaps}})(de),be=t(67),fe=t(19),me=t(68),Oe=function(){function e(n){Object(be.a)(this,e),this.dispatch=n}return Object(fe.a)(e,[{key:"initYMaps",value:function(){var e=this;me.a.load("https://api-maps.yandex.ru/2.1/?apikey=ec0ad35b-0d65-48bb-aff9-8343ba56b035&lang=en_US").then(function(n){return e.dispatch((t=n,{type:m.INIT_YMAPS_API,payload:{yMapsApi:t}}));var t}).catch(function(e){return console.log("Failed to load Yandex Maps",e)})}}]),e}(),ge=Object(r.memo)(function(e){var n=e.dispatch;return Object(r.useEffect)(function(){new Oe(n).initYMaps()},[n]),a.a.createElement("div",null,a.a.createElement(ue,null),a.a.createElement(pe,null))}),ve=Object(c.b)()(ge);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(c.a,{store:D},a.a.createElement(ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},20:function(e){e.exports=JSON.parse('{"mobileMaxWidth":1024,"desktopMinWidth":1025}')},72:function(e,n,t){e.exports=t(125)},87:function(e,n,t){}},[[72,1,2]]]);
//# sourceMappingURL=main.e18458c3.chunk.js.map