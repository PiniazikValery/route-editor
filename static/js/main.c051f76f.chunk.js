(window["webpackJsonproute-editor"]=window["webpackJsonproute-editor"]||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),c=n.n(o),i=n(2),l=n(3),u=n(6),d=n(8),s=n(41),p=n.n(s),g=function(e,t,n){var a=p()();return{type:f.ADD_COORD,payload:{id:a,name:e,lat:t,lng:n}}},m=function(e){return{type:f.DELETE_COORD,payload:{id:e}}},f={ADD_COORD:"ADD_COORD",DELETE_COORD:"DELETE_COORD",DND_COORD:"DND_COORD",INIT_YMAPS_API:"INIT_YMAPS_API",EDIT_COORD:"EDIT_COORD"},O=[],b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.ADD_COORD:var n=t.payload,a=n.id,r=n.name,o=n.lat,c=n.lng,i={name:r,lat:o,lng:c,id:a};return[].concat(Object(d.a)(e),[i]);case f.DELETE_COORD:var l=t.payload.id,s=Object(d.a)(e),p=s.splice(s.findIndex(function(e){return e.id===l}),1);return[].concat(Object(d.a)(s.slice(0,p)),Object(d.a)(s.slice(p+1)));case f.DND_COORD:var g=t.payload,m=g.startIndex,b=g.endIndex;if(m!==b){var v=Object(d.a)(e),h=v.splice(m,1),E=Object(u.a)(h,1),y=E[0];return v.splice(b,0,y),v}return e;case f.EDIT_COORD:var j=t.payload,D=j.id,C=j.name,_=j.lat,I=j.lng,w=Object(d.a)(e);return w.map(function(e){return e.id===D&&(e.name=C,e.lat=_,e.lng=I),e});default:return e}},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.INIT_YMAPS_API:var n=t.payload.yMapsApi;return n;default:return e}},h=Object(l.c)({coords:b,yMaps:v}),E=Object(l.e)(h),y=(n(69),n(12)),j=n.n(y),D=n(25),C=Object(a.memo)(function(e){var t=e.dispatch,n=e.yMaps,o=Object(a.useState)(""),c=Object(u.a)(o,2),i=c[0],l=c[1],d=Object(a.useState)(""),s=Object(u.a)(d,2),p=s[0],m=s[1],f=Object(a.useState)(""),O=Object(u.a)(f,2),b=O[0],v=O[1],h=function(){var e=Object(D.a)(j.a.mark(function e(n){var a,r,o,c;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),l(""),v(""),m(""),e.next=4,E(i,b,p);case 4:a=e.sent,r=a.gcoordName,o=a.glat,c=a.glng,a.decodeError||t(g(r,o,c));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(D.a)(j.a.mark(function e(t,a,r){var o,c;return j.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o={gcoordName:t,glat:a,glng:r},c=function(e){var t=e.geoObjects.get(0);if(t){var n=t.getAddressLine(),a=t.geometry.getCoordinates();o.gcoordName=n,o.glat=a[1],o.glng=a[0]}else o.decodeError=!0},e.t0=!0,e.next=e.t0===(""!==a&&""!==r)?5:e.t0===(""!==t)?8:11;break;case 5:return e.next=7,n.geocode([a,r]).then(c);case 7:return e.abrupt("break",12);case 8:return e.next=10,n.geocode(t).then(c);case 10:case 11:return e.abrupt("break",12);case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}();return r.a.createElement("form",{onSubmit:h},r.a.createElement("p",null,"\u0418\u043c\u044f \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b:"),r.a.createElement("input",{onChange:function(e){l(e.target.value)},value:i,placeholder:"\u0418\u043c\u044f \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u044b"}),r.a.createElement("p",null,"\u0414\u043e\u043b\u0433\u043e\u0442\u0430:"),r.a.createElement("input",{onChange:function(e){isNaN(e.target.value)||m(e.target.value)},value:p,placeholder:"\u0414\u043e\u043b\u0433\u043e\u0442\u0430"}),r.a.createElement("p",null,"\u0428\u0438\u0440\u043e\u0442\u0430:"),r.a.createElement("input",{onChange:function(e){isNaN(e.target.value)||v(e.target.value)},value:b,placeholder:"\u0428\u0438\u0440\u043e\u0442\u0430"}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",value:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043e\u0440\u0434\u0438\u043d\u0430\u0442\u0443"}))}),_=Object(i.b)(function(e){return{yMaps:e.yMaps}})(C),I=Object(a.memo)(function(e){var t=e.dispatch,n=e.name,a=e.lng,o=e.lat,c=e.id;return r.a.createElement("div",null,r.a.createElement("label",null,"\u0418\u043c\u044f: ".concat(n,"; \u0434\u043e\u043b\u0433\u043e\u0442\u0430:").concat(a,"; \u0448\u0438\u0440\u043e\u0442\u0430: ").concat(o)),r.a.createElement("button",{onClick:function(){t(m(c))}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"))}),w=Object(i.b)()(I),A=n(20),R=Object(a.memo)(function(e){var t=e.coords,n=e.dispatch;return r.a.createElement(A.a,{onDragEnd:function(e){var t,a;e.destination&&n((t=e.source.index,a=e.destination.index,{type:f.DND_COORD,payload:{startIndex:t,endIndex:a}}))}},r.a.createElement(A.c,{droppableId:"droppable"},function(e){return r.a.createElement("div",Object.assign({},e.droppableProps,{ref:e.innerRef}),t.map(function(e,t){return r.a.createElement(A.b,{key:e.id,draggableId:e.id,index:t},function(t){return r.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps),r.a.createElement(w,{key:e.id,name:e.name,lat:e.lat,lng:e.lng,id:e.id}))})}),e.placeholder)}))}),x=Object(i.b)(function(e){return{coords:e.coords}})(R),M=n(45);function k(){var e=Object(M.a)(["\n    width: 80%;\n    height: 100vh;\n"]);return k=function(){return e},e}var N=n(46).a.div(k()),P=Object(a.memo)(function(e){var t=e.coords,n=e.yMaps,o=e.dispatch,c=Object(a.useState)(null),i=Object(u.a)(c,2),l=i[0],d=i[1];Object(a.useEffect)(function(){l||d(n?new n.Map("map",{center:[55.76,37.64],zoom:7,controls:[]}):null)},[n,l]);var s,p=function(e,t){var a=t.originalEvent.target.geometry.getCoordinates();n.geocode(a).then(function(t){var n=t.geoObjects.get(0),a=n.getAddressLine(),r=n.geometry.getCoordinates();o(function(e,t,n,a){return{type:f.EDIT_COORD,payload:{id:e,name:t,lat:n,lng:a}}}(e,a,r[1],r[0]))})},g=function(e){return e.map(function(e){return[+e.lng,+e.lat]})};return r.a.createElement("div",null,r.a.createElement(N,{id:"map",key:"map"}),l?void((s=t).length>1?n.route(g(s)).then(function(e){for(var t=e.getWayPoints(),a=function(e){n.geocode(t.get(e).geometry.getCoordinates()).then(function(a){t.get(e).options.set({balloonContentLayout:n.templateLayoutFactory.createClass("<span>".concat(a.geoObjects.get(0).getAddressLine(),"</span>"))})}),t.get(e).events.add("dragend",function(t){return p(s[e].id,t)})},r=0;r<t.getLength();r++)a(r);e.editor.start({addViaPoints:!1}),l.geoObjects.removeAll(),l.geoObjects.add(e),n.geocode(g(s)[s.length-1]).then(function(e){l.setCenter(e.geoObjects.get(0).geometry.getCoordinates(),7)})},function(e){o(m(s[s.length-1].id)),alert("error: "+e.message)}):l.geoObjects.removeAll()):void 0)}),T=Object(i.b)(function(e){return{coords:e.coords,yMaps:e.yMaps}})(P),L=n(49),S=n(50),Y=n(51),W=function(){function e(t){Object(L.a)(this,e),this.dispatch=t}return Object(S.a)(e,[{key:"initYMaps",value:function(){var e=this;Y.a.load("https://api-maps.yandex.ru/2.1/?apikey=ec0ad35b-0d65-48bb-aff9-8343ba56b035&lang=en_US").then(function(t){return e.dispatch((n=t,{type:f.INIT_YMAPS_API,payload:{yMapsApi:n}}));var n}).catch(function(e){return console.log("Failed to load Yandex Maps",e)})}}]),e}(),B=Object(a.memo)(function(e){var t=e.dispatch;return Object(a.useEffect)(function(){new W(t).initYMaps()},[t]),r.a.createElement("div",null,r.a.createElement(_,null),r.a.createElement(x,null),r.a.createElement(T,null))}),F=Object(i.b)()(B);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(i.a,{store:E},r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},54:function(e,t,n){e.exports=n(106)},69:function(e,t,n){}},[[54,1,2]]]);
//# sourceMappingURL=main.c051f76f.chunk.js.map